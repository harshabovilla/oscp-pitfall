| #  | Pitfall / Gotcha                                   | Why it kills you in OSCP                                                                 | How to avoid / fix it                                                                                           |
|----|----------------------------------------------------|-------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------|
| 1  | File is locked / in use                            | Can't overwrite the .exe because the service is running                                  | `sc stop <svc>` first → if fails: `taskkill /F /PID <pid>` or use Handle.exe / Process Explorer                    |
| 2  | Service won’t stop (no permission)                 | Low-priv user often can’t stop/restart services                                          | Reboot the box: `shutdown /r /t 0`. Auto-start services trigger payload on boot. Listener must be ready!          |
| 3  | Wrong architecture payload                         | 64-bit payload on 32-bit service (or vice versa) → service crashes or won’t start         | Check path (Program Files vs Program Files (x86)). Generate both x86 & x64 payloads. Test with whoami.exe first |
| 4  | AV / Windows Defender eats your payload            | You upload → instantly deleted → no shell                                                 | Use encoded msfvenom, compile C# shell (SharpShell), or test with harmless `whoami.exe` first                    |
| 5  | Service runs as LocalService/NetworkService        | You get a shell but still not SYSTEM/admin → can’t read root.txt or add users            | Always check `sc qc <svc>` → look at SERVICE_START_NAME. Only SYSTEM or local admin gives real privesc           |
| 6  | icacls says you have permission but you can’t write| Integrity level (Medium vs Low) or hidden Deny ACEs                                       | Run `whoami /groups` (Low Mandatory Level = dead). Use `accesschk.exe -l "path\to\exe"` for real permissions     |
| 7  | Permissions/owner changed after overwrite          | Service fails with “Access denied” or error 1053 after you replace the binary            | Before overwrite: `icacls "file" /save acl.txt` → after: `icacls "file" /restore acl.txt`                         |
| 8  | Confusing with unquoted service path               | You waste time trying to overwrite when it’s actually unquoted path exploitation         | If path has spaces & no quotes → drop malicious.exe in intermediate folder (e.g., C:\Program.exe)               |
| 9  | Service is Manual (DEMAND_START)                   | You reboot and nothing triggers                                                           | Check START_TYPE with `sc qc <svc>`. If Manual and nobody starts it → look for another vector                     |
|10  | Shell dies immediately after connect               | Service watchdog restarts or payload exits too fast                                       | Use persistent payload (Meterpreter, `while($true){start-sleep 999}` loop) or disable failure recovery           |
